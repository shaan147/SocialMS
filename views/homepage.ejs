<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Social MS</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
  <!-- Link to external CSS file -->
  <link rel="stylesheet" href="/stylesheets/styles.css">
</head>

<body>
  <h1>Hello</h1>

  <h2 class="section-title">User Data</h2>
  <% if (userData) { %>
  <div class="user-data">
    <p class="user-data-field">Name: <%= userData.name %></p>
    <p class="user-data-field">Email: <%= userData.email %></p>
    <p class="user-data-field">Birthday: <%= userData.birthday %></p>
    <p class="user-data-field">Gender: <%= userData.gender %></p>
    <% if (userData.hometown) { %>
    <p class="user-data-field">Hometown: <%= userData.hometown.name %></p>
    <% } %>
    <p class="user-data-field">
      Link:
      <a href="<%= userData.link %>" class="user-link" target="_blank" rel="noopener noreferrer"><%= userData.link %></a>
    </p>
    <% if (userData.age_range && userData.age_range.min && userData.age_range.max) { %>
    <p class="user-data-field">Age Range: <%= userData.age_range %> </p>
    <% } else { %>
    <p class="user-data-field">Age Range: Not specified</p>
    <% } %>
  </div>
  <% } else { %>
  <p>Loading user data...</p>
  <% } %>

  <h2 style="display: flex; justify-content: center;">User's Words Analysis</h2>
  <canvas id="wordCountChart" style="display: flex; justify-content: center; width:100%; max-width:1200px; height:500px; font-size: 1.2rem;"></canvas>
  <br> <br>
  <h2 style="display: flex; justify-content: center;">User's Sentiment Analysis</h2>
  <div class="height: auto; width: auto;">
  <canvas id="sentimentChart" style="width: 260px; height: 260px;"></canvas>
</div>
</body>
<script>
  const mostCommonWordsData = <%- JSON.stringify(mostCommonWords) %>;
  new Chart("wordCountChart", {
    type: "line",
    data: {
      labels: mostCommonWordsData.map(item => item.word),
      datasets: [{
        label: 'Word Count',
        backgroundColor: "rgba(0,0,255,0.1)", 
        borderColor: "rgba(0,0,255,1.0)", 
        pointBackgroundColor: "rgba(255,0,0,1.0)", 
        pointBorderColor: "rgba(255,0,0,1.0)", 
        data: mostCommonWordsData.map(item => item.count)
      }]
    },
    options: {
      scales: {
        yAxes: [{
          ticks: {
            beginAtZero: true,
            max: Math.max(...mostCommonWordsData.map(item => item.count)),
            fontSize: 17
          }
        }],
        xAxes: [{
          ticks: {
            fontSize: 17
          }
        }]
      },
      legend: {
        labels: {
          fontSize: 17
        }
      }
    }
  });

  const sentiment = <%- JSON.stringify(sentiment) %>;
  const sentimentScore = sentiment.score;

  const sentimentChartData = {
    labels: ['Positive Sentiment', 'Negative Sentiment'],
    datasets: [{
      data: [sentimentScore, 100 - sentimentScore],
      backgroundColor: ['rgba(0, 255, 0, 1.0)', 'rgba(255, 0, 0, 1.0)']
    }]
  };

  const sentimentChartOptions = {
    responsive: true,
    maintainAspectRatio: false
  };

  new Chart("sentimentChart", {
    type: "pie",
    data: sentimentChartData,
    options: sentimentChartOptions
  });
</script>

</html>
